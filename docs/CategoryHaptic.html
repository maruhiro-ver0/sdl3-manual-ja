<!DOCTYPE html>
<html lang="ja-JP">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="keywords" content="Simple Directmedia Layer SDL3.0">
<link rel="top" href="index.html" title="ホーム">
<link rel="parent" href="ApiByCategory.html" title="1つ上">
<title>力覚フィードバック</title>
</head>
<body>
<a href="index.html">目次</a> - <a href="ApiByCategory.html">SDL 3.0 API(機能別)</a> - 力覚フィードバック
<hr>
<h1>力覚フィードバック</h1>
<h2>概要</h2>
<p>
SDLハプティックサブシステムはハプティックデバイス(力覚装置)を扱う.
</p>
<p>
基本的な使い方は次の通りである.
<ol>
<li>サブシステム(SDL_INIT_HAPTIC)を初期化する
<li>ハプティックデバイスを開く
<ul>
<li>SDL_OpenHaptic()でインデックス番号を指定して開く
<li>SDL_OpenHapticFromJoystick()でジョイスティックから開く
</ul>
<li>効果を生成する (SDL_HapticEffect)
<li>効果をアップロードする SDL_CreateHapticEffect()
<li>効果をSDL_HapticRunEffect()</a>で再生する SDL_RunHapticEffect()
<li>(任意) 効果をSDL_DestroyHapticEffect()で解放する
<li>ハプティックデバイスをSDL_CloseHaptic()で閉じる
</ol>
</p>
<h3>振動させる簡単な例</h3>
<p>
<code>
<pre>
   SDL_Haptic *haptic = NULL;

   // デバイスを開く
   SDL_HapticID *haptics = SDL_GetHaptics(NULL);
   if (haptics) {
       haptic = SDL_OpenHaptic(haptics[0]);
       SDL_free(haptics);
   }
   if (haptic == NULL)
      return;

   // 単純な振動で初期化する
   if (!SDL_InitHapticRumble(haptic))
      return;

   // 50%の強さで2秒間再生する
   if (!SDL_PlayHapticRumble(haptic, 0.5, 2000))
      return;
   SDL_Delay(2000);

   // 終了する
   SDL_CloseHaptic(haptic);
</pre>
</code>
</p>
<h3>完全なコード</h3>
<p>
<code>
<pre>
bool test_haptic(SDL_Joystick *joystick)
{
   SDL_Haptic *haptic;
   SDL_HapticEffect effect;
   SDL_HapticEffectID effect_id;

   // デバイスを開く
   haptic = SDL_OpenHapticFromJoystick(joystick);
   if (haptic == NULL) return false; // ジョイスティックにハプティックがない場合が大半

   // サイン波が可能か調べる
   if ((SDL_GetHapticFeatures(haptic) &amp; SDL_HAPTIC_SINE)==0) {
      SDL_CloseHaptic(haptic); // サイン効果がない
      return false;
   }

   // 効果を生成する
   SDL_memset(&amp;effect, 0, sizeof(SDL_HapticEffect)); // 安全のためデフォルトを0にする
   effect.type = SDL_HAPTIC_SINE;
   effect.periodic.direction.type = SDL_HAPTIC_POLAR; // 極座標系
   effect.periodic.direction.dir[0] = 18000; // 効果は南から来る
   effect.periodic.period = 1000; // 1000ミリ秒
   effect.periodic.magnitude = 20000; // 20000/32767 の強さ
   effect.periodic.length = 5000; // 5秒間
   effect.periodic.attack_length = 1000; // 1秒間で最大に達する
   effect.periodic.fade_length = 1000; // 1秒間で停止する

   // 効果をアップロードする
   effect_id = SDL_CreateHapticEffect(haptic, &amp;effect);

   // 効果をテストする
   SDL_RunHapticEffect(haptic, effect_id, 1);
   SDL_Delay(5000); // 効果が終わるまで待つ

   // 効果を破棄する. これはデバイスを閉じても行われる
   SDL_DestroyHapticEffect(haptic, effect_id);

   // デバイスを閉じる
   SDL_CloseHaptic(haptic);

   return true; // 成功
}
</pre>
</code>
</p>
<p>
SDLハプティックサブシステムはスレッドセーフではないので注意すること.
</p>
<h2>関数</h2>
<ol>
<li>SDL_CloseHaptic
<li>SDL_CreateHapticEffect
<li>SDL_DestroyHapticEffect
<li>SDL_GetHapticEffectStatus
<li>SDL_GetHapticFeatures
<li>SDL_GetHapticFromID
<li>SDL_GetHapticID
<li>SDL_GetHapticName
<li>SDL_GetHapticNameForID
<li>SDL_GetHaptics
<li>SDL_GetMaxHapticEffects
<li>SDL_GetMaxHapticEffectsPlaying
<li>SDL_GetNumHapticAxes
<li>SDL_HapticEffectSupported
<li>SDL_HapticRumbleSupported
<li>SDL_InitHapticRumble
<li>SDL_IsJoystickHaptic
<li>SDL_IsMouseHaptic
<li>SDL_OpenHaptic
<li>SDL_OpenHapticFromJoystick
<li>SDL_OpenHapticFromMouse
<li>SDL_PauseHaptic
<li>SDL_PlayHapticRumble
<li>SDL_ResumeHaptic
<li>SDL_RunHapticEffect
<li>SDL_SetHapticAutocenter
<li>SDL_SetHapticGain
<li>SDL_StopHapticEffect
<li>SDL_StopHapticEffects
<li>SDL_StopHapticRumble
<li>SDL_UpdateHapticEffect
</ol>
<h2>型</h2>
<ol>
<li>SDL_Haptic
<li>SDL_HapticDirectionType
<li>SDL_HapticEffectID
<li>SDL_HapticEffectType
<li>SDL_HapticID
</ol>
<h2>構造体</h2>
<ol>
<li>SDL_HapticCondition
<li>SDL_HapticConstant
<li>SDL_HapticCustom
<li>SDL_HapticDirection
<li>SDL_HapticEffect
<li>SDL_HapticLeftRight
<li>SDL_HapticPeriodic
<li>SDL_HapticRamp
</ol>
<h2>マクロ</h2>
<ol>
<li>SDL_HAPTIC_AUTOCENTER
<li>SDL_HAPTIC_CARTESIAN
<li>SDL_HAPTIC_CONSTANT
<li>SDL_HAPTIC_CUSTOM
<li>SDL_HAPTIC_DAMPER
<li>SDL_HAPTIC_FRICTION
<li>SDL_HAPTIC_GAIN
<li>SDL_HAPTIC_INERTIA
<li>SDL_HAPTIC_INFINITY
<li>SDL_HAPTIC_LEFTRIGHT
<li>SDL_HAPTIC_PAUSE
<li>SDL_HAPTIC_POLAR
<li>SDL_HAPTIC_RAMP
<li>SDL_HAPTIC_RESERVED1
<li>SDL_HAPTIC_RESERVED2
<li>SDL_HAPTIC_RESERVED3
<li>SDL_HAPTIC_SAWTOOTHDOWN
<li>SDL_HAPTIC_SAWTOOTHUP
<li>SDL_HAPTIC_SINE
<li>SDL_HAPTIC_SPHERICAL
<li>SDL_HAPTIC_SPRING
<li>SDL_HAPTIC_SQUARE
<li>SDL_HAPTIC_STATUS
<li>SDL_HAPTIC_STEERING_AXIS
<li>SDL_HAPTIC_TRIANGLE
</ol>
<h2>SDL Wikiへのリンク</h2>
<a href="https://wiki.libsdl.org/SDL3/CategoryHaptic">SDL3/CategoryHaptic - SDL Wiki</a>
<hr>
</body>
</html>
